{"version":3,"file":"js/pieGraph-2dd73b1194ab5e82e93e.js","sources":["webpack:///webpack/bootstrap","webpack:///./app/javascript/packs/pieGraph.js"],"sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/packs/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./app/javascript/packs/pieGraph.js\");\n","const pieGraph = {\n\tbuildPieGraph: function(stateDisplay, state, choice) {\n\n\n\t  let customArray, colorRange, data;\n\n\t  if(choice == 'LAN7'){\n\t  \tcustomArray = [4,5,6];\n\t  \tcolorRange = [\"#8a89a6\", \"#7b6888\", \"#6b486b\"];\n\t  \tdata = this.createPieData(customArray, state.data);\n\t  } else if(choice == 'LAN'){\n\t  \tcustomArray = state.filtered.map((el,i)=> i);\n\t  \tcolorRange = ['#AFB42B',\n\t\t\t\t'#9E9D24',\n\t\t\t\t'#827717',\n\t\t\t\t'#F4FF81',\n\t\t\t\t'#EEFF41',\n\t\t\t];\n\t\t\tdata = this.createPieData(customArray, state.filtered);\n\t  }\n\n\t  let keys = data[1];\n\n\t\tdata = data[0];\n\n\t\t\t  function makeData() {\n\n  var data = Array();\n\n  for (i = 0; i < keys.length; i++) {\n    if (Math.random() < 0.7) {\n      var ob = {};\n      ob[\"label\"] = keys[i];\n      ob[\"value\"] = randomCount(1, 100);\n      data.push(ob);\n    }\n  }\n\n  var sortedData = data.sort(function(a, b) {\n      return d3.ascending(a.label, b.label);\n    });\n\n  return sortedData;\n}\nfunction randomCount(min, max) {\n\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n}\n\nvar t = makeData();\n\n\n\t  // set the dimensions and margins of the graph\n\t  var width = 330,\n\t      height = 270,\n\t      margin = 40;\n\n\t  var radius = Math.min(width, height) / 2 - margin;\n\n\t  var svg = stateDisplay\n\t\t  .append(\"svg\")\n\t\t  \t.attr(\"id\", \"pie-graph\")\n\t\t    .attr(\"width\", width)\n\t\t    .attr(\"height\", height)\n\t\t  .append(\"g\")\n\t\t    .attr(\"transform\", \"translate(\" + width / 2 + \",\" + ((height / 2) + 15) + \")\");\n\n\t\tsvg.append(\"g\").attr(\"class\", \"slices\");\n\n\t\tvar pie = d3.pie()\n\t\t  .sort(null)\n\t\t  .value(function(d) {\n\t\t    return d.value;\n\t\t  });\n\n\t\tvar arc = d3.arc()\n\t\t  .outerRadius(radius * 1.0)\n\t\t  .innerRadius(radius * 0.0);\n\n\t\tvar outerArc = d3.arc()\n\t\t  .innerRadius(radius * 0.5)\n\t\t  .outerRadius(radius * 1);\n\n\t\tvar key = function(d) { return d.data.label; };\n\n\t\tvar color = d3.scaleOrdinal(d3.schemePastel1)\n\t\t    .domain(keys);\n\n\n\t\t\n\t\tupdate(data);\n\n\t\t// var inter = setInterval(function() {\n  //   update(data);\n  // }, 2000);\n\t\tfunction mergeWithFirstEqualZero(first, second){\n\n\t\t  var secondSet = d3.set();\n\n\t\t  second.forEach(function(d) { secondSet.add(d.label); });\n\n\t\t  var onlyFirst = first\n\t\t    .filter(function(d){ return !secondSet.has(d.label) })\n\t\t    .map(function(d) { return {label: d.label, value: 0}; });\n\n\t\t  var sortedMerge = d3.merge([ second, onlyFirst ])\n\t\t    .sort(function(a, b) {\n\t\t        return d3.ascending(a.label, b.label);\n\t\t      });\n\n\t\t  return sortedMerge;\n\t\t}\n\n\t\tfunction update(data) {\n\n\t    var duration = 500;\n\n\t    var oldData = svg.select(\".slices\")\n\t      .selectAll(\"path\")\n\t      .data().map(function(d) { return d.data });\n\n\t    if (oldData.length == 0) oldData = data;\n\n\t    var was = mergeWithFirstEqualZero(data, oldData);\n\t    var is = mergeWithFirstEqualZero(oldData, data);\n\n\t    var slice = svg.select(\".slices\")\n\t      .selectAll(\"path\")\n\t      .data(pie(was), key);\n\n\t    slice.enter()\n\t      .insert(\"path\")\n\t      .attr(\"class\", \"slice\")\n\t      .style(\"fill\", function(d) { return color(d.data.label); })\n\t      .each(function(d) {\n\t          this._current = d;\n\t        })\n\t      .on(\"click\", function(d) {\n\t        hoverInfo.style(\"display\", \"none\");\n\t        hoverInfo.style(\"display\", null);\n\t        var xPosition = d3.mouse(this)[0] - 5;\n\t        var yPosition = d3.mouse(this)[1] - 5;\n\t        hoverInfo.attr(\"transform\", \"translate(\" + xPosition + \",\" + yPosition + \")\");\n\t        hoverInfo.select(\"text\").text(d.value);\n\t    });\n\n\t    slice = svg.select(\".slices\")\n\t      .selectAll(\"path\")\n\t      .data(pie(is), key);\n\n\t    slice.transition()\n\t      .duration(duration)\n\t      .attrTween(\"d\", function(d) {\n\t          var interpolate = d3.interpolate(this._current, d);\n\t          var _this = this;\n\t          return function(t) {\n\t              _this._current = interpolate(t);\n\t              return arc(_this._current);\n\t            };\n\t        });\n\n\t    slice = svg.select(\".slices\")\n\t      .selectAll(\"path\")\n\t      .data(pie(data), key);\n\n\t    slice.exit()\n\t      .transition()\n\t      .delay(duration)\n\t      .duration(0)\n\t      .remove();\n\t\t};\n\t //  // The radius of the pieplot is half the width or half the height (smallest one). I subtract a bit of margin.\n\t //  var radius = Math.min(width, height) / 2 - margin;\n\n\t //  // append the svg object to the div called 'my_dataviz'\n\t //  var svg = stateDisplay\n\t //    .append(\"svg\")\n\t //      .attr(\"id\", \"pie-graph\")\n\t //      .attr(\"width\", width)\n\t //      .attr(\"height\", height)\n\t //    .append(\"g\")\n\t //      .attr(\"transform\", \"translate(\" + width / 2 + \",\" + ((height / 2) + 15) + \")\");\n\n\t //  let customArray, colorRange, data;\n\n\t //  if(choice == 'LAN7'){\n\t //  \tcustomArray = [4,5,6];\n\t //  \tcolorRange = [\"#8a89a6\", \"#7b6888\", \"#6b486b\"];\n\t //  \tdata = this.createPieData(customArray, state.data);\n\t //  } else if(choice == 'LAN'){\n\t //  \tcustomArray = state.filtered.map((el,i)=> i);\n\t //  \tcolorRange = ['#AFB42B',\n\t\t// \t\t'#9E9D24',\n\t\t// \t\t'#827717',\n\t\t// \t\t'#F4FF81',\n\t\t// \t\t'#EEFF41',\n\t\t// \t];\n\t\t// \tdata = this.createPieData(customArray, state.filtered);\n\t //  }\n\n\t\t// let keys = data[1];\n\n\t\t// data = data[0];\n\t\t\n\t //  // set the color scale\n\t //  var color = d3.scaleOrdinal()\n\t //    .domain(data)\n\t //    .range(colorRange);\n\n\t //  // Compute the position of each group on the pie:\n\t //  var pie = d3.pie()\n\t //    .value(function(d) {return d.value; });\n\n\t //  var data_ready = pie(d3.entries(data));\n\n\t //  // make this into a function to rebuild the graph every time USCensu is called\n\t //  // setTimeout(function(){ \n\t //  svg\n\t //    .selectAll('whatever')\n\t //    .data(data_ready)\n\t //    .enter()\n\t //    .append('path')\n\t //    .attr('d', d3.arc()\n\t //      .innerRadius(0)\n\t //      .outerRadius(radius)\n\t //    )\n\t //    .attr('fill', function(d){ return(color(d.data.key)) })\n\t //    .attr(\"stroke\", \"black\")\n\t //    .style(\"stroke-width\", \"1px\")\n\t //    .on(\"click\", function(d) {\n\t //        hoverInfo.style(\"display\", \"none\");\n\t //        hoverInfo.style(\"display\", null);\n\t //        var xPosition = d3.mouse(this)[0] - 5;\n\t //        var yPosition = d3.mouse(this)[1] - 5;\n\t //        hoverInfo.attr(\"transform\", \"translate(\" + xPosition + \",\" + yPosition + \")\");\n\t //        hoverInfo.select(\"text\").text(d.value);\n\t //    });\n\n\t  stateDisplay.append('svg')\n\t    .attr(\"id\", \"legend\")\n\t    .attr(\"dy\", width)\n\t      // .attr(\"height\", height)\n\t  // Add one dot in the legend for each name.\n\t  var legend = d3.select(\"#legend\")\n\n\t  legend.selectAll(\"mydots\")\n\t    .data(keys)//data)\n\t    .enter()\n\t    .append(\"circle\")\n\t      .attr(\"class\", \"circle\")\n\t      .attr(\"cx\", function(d,i){\n\t      \tif(i < 3)\n\t      \t\treturn 40;\n\t      \telse\n\t      \t\treturn 200;\n\t      })\n\t      .attr(\"cy\", function(d,i){ \n\t      \tif(i < 3)\n\t\t      \treturn 265 + i*25\n\t\t      else\n\t\t      \treturn 265 + (i-3)*25\n\t      \t}) // 100 is where the first dot appears. 25 is the distance between dots\n\t      .attr(\"r\", 7)\n\t      .style(\"fill\", function(d){ return color(d)})\n\n\t  // Add one dot in the legend for each name.\n\t  legend.selectAll(\"mylabels\")\n\t    .data(keys)//data)\n\t    .enter()\n\t    .append(\"text\")\n\t      .attr(\"x\", function(d,i){\n\t      \tif(i < 3)\n\t      \t\treturn 60;\n\t      \telse\n\t      \t\treturn 220;\n\t      })\n\t      .attr(\"y\", function(d,i){ \n\t      \tif(i < 3)\n\t\t      \treturn 265 + i*25\n\t\t      else\n\t\t      \treturn 265 + (i-3)*25\n\t      \t}) // 100 is where the first dot appears. 25 is the distance between dots\n\t      .style(\"fill\", \"grey\")//function(d){ return color(d)})\n\t      .text(function(d){ return d})\n\t      .attr(\"text-anchor\", \"left\")\n\t      .attr(\"font-size\", \"12px\")\n\t      .style(\"alignment-baseline\", \"middle\")\n\t      // .style(\"opacity\", 0.7)\n\n\t  // create hover info\n\t  var hoverInfo = svg.append(\"g\")\n\t    .attr(\"class\", \"hover-info\")\n\t    .style(\"display\", \"none\");\n\t      \n\t  // TASK 2: build rect display for the tool tip  \n\t  hoverInfo.append(\"rect\")\n\t    .attr(\"width\", 60)\n\t    .attr(\"height\", 20)\n\t    .attr(\"rx\", 5)\n\t    .attr(\"ry\", 5)\n\t    .attr(\"fill\", \"white\")\n\t    .style(\"opacity\", 1);\n\n\t  // TASK 2: configure the text for the hoverInfo\n\t  hoverInfo.append(\"text\")\n\t    .attr(\"x\", 30)\n\t    .attr(\"dy\", \"1.2em\")\n\t    .style(\"text-anchor\", \"middle\")\n\t    .attr(\"font-size\", \"12px\")\n\t    .attr(\"font-weight\", \"bold\");\n\n\t}, \n\n\tcreatePieData: function(customArray, data){\n\t\t// var //key1 = state.data[2][1], \n\t //    key2 = state.data[4][1],\n\t //    key3 = state.data[5][1],\n\t //    key4 = state.data[6][1];\n\n\t //  var keys = [key2, key3, key4];\n\n\t //  var //val1 = state.data[2][0],\n\t //    val2 = state.data[4][0],\n\t //    val3 = state.data[5][0],\n\t //    val4 = state.data[6][0];\n\n\t //  var vals = [val2, val3, val4];\n\n\t  var keys = customArray.map((el)=> data[el][1]);\n\t  var vals = customArray.map((el)=> data[el][0]);\n\n\t  var newData = [];\n\n\n\t  \n\t  keys.forEach((el, i)=>{\n\t    newData.push({label: el, value: vals[i]});\n\t  })\n\n\t  return [newData, keys];\n\t}\n};\n\nmodule.exports = pieGraph;\n"],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AClFA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAMA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAGA;AAAA;AAAA;AAIA;AAEA;AAQA;AAEA;AAGA;AACA;AAEA;AAIA;AACA;AAGA;AAAA;AAAA;AACA;AACA;AAKA;AAGA;AACA;AACA;AAAA;AAEA;AAEA;AAAA;AAAA;AAEA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAEA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAEA;AAEA;AAAA;AAEA;AAEA;AACA;AAEA;AAIA;AAGA;AAAA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAIA;AAGA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAEA;AAIA;AAKA;AACA;AADA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AAAA;AAEA;AAAA;AAMA;AAIA;AAEA;AAIA;AAhBA;AAkBA;AAAA;AACA;AAEA;AAAA;AAKA;AAIA;AAEA;AAIA;AAfA;AAAA;AAiBA;AAAA;AAMA;AACA;AAAA;AACA;AAIA;AACA;AAQA;AAOA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAEA;AAEA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AAIA;AACA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AApVA;AAuVA;;;;A","sourceRoot":""}